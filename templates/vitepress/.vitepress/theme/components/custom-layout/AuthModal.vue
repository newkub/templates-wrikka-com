<script setup>
import { SignOutButton, SignedIn, SignedOut, UserButton } from "@clerk/vue";
import { useAuth } from "@theme/composables/useAuth";
import { onMounted } from "vue";

const { showAuthModal, closeAuthModal, clerk, isLoading, isCustomer, user } =
	useAuth();

onMounted(() => {
	const script = document.createElement("script");
	script.src = "https://js.stripe.com/v3/buy-button.js";
	script.async = true;
	document.head.appendChild(script);
});
</script>

<template>
	<Teleport to="body">
		<div v-if="showAuthModal" @click="closeAuthModal"
			class="flex flex-col items-center justify-center gap-5 w-full fixed inset-0 bg-black bg-opacity-82 z-50">
			<div @click.stop
				class="flex flex-col gap-5 bg-gray-800 bg-opacity-50 backdrop-blur-md p-5 rounded-md max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl mx-4 sm:mx-6 md:mx-8 lg:mx-12">
				<SignedOut>
					<p class="text-white text-2xl font-bold text-center">üîë Wrika all in one</p>
					<p class="text-yellow-400 text text-center text-base font-bold">‚ö†Ô∏è ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÉ‡∏ô 5
						‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2025</p>
					<p class="text-gray-300 text text-center text-base">‡πÅ‡∏ä‡∏£‡πå‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡∏£‡∏π‡πâ</p>
					<p class="text-gray-300 text text-center text-base">‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ</p>
					<p class="text-center text-[#ff4d4d]">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
					<div class="flex flex-row gap-3">
						<button class="w-full bg-white p-2 rounded-md transition-colors duration-300 text-dark text-base"
							@click="clerk.openSignUp">‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
						<button class="w-full bg-[#2176ff] p-2 rounded-md transition-colors duration-300 text-white text-base"
							@click="clerk.openSignIn">‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
						</button>
					</div>
				</SignedOut>

				<SignedIn>
					<div v-if="!isLoading && !isCustomer" class="flex flex-col gap-5">
						<div class="flex flex-col items-center gap-3">
							<p class="text-lg text-red">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</p>
							<p class="text-gray text-base">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
							<div class="flex flex-tow items-center gap-2 text-white">
								<span>{{ user.primaryEmailAddress }}</span>
								<UserButton />
							</div>
							<stripe-buy-button buy-button-id="buy_btn_1PWAsuBzfjWMkCdE1FX3zvGS"
								publishable-key="pk_live_51OQ5XMBzfjWMkCdE0EaQCiKg9bO5BMr7CsjLZ7cXKv5xthA9X9qiXBQXSKnnorEwrK31bkAEjXJGahWDMSZrURZI00YPK7OCOP">
							</stripe-buy-button>
							<SignOutButton class="text-base hover:text-red">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</SignOutButton>
						</div>
					</div>
				</SignedIn>
			</div>
		</div>
	</Teleport>
</template>